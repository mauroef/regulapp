import type { NextPage } from 'next'
import Head from 'next/head'
import styles from '../styles/Home.module.css'
import api from '../api/db'
import { Timestamp } from 'firebase/firestore'
import { useAuth } from '../hooks/useAuth'
import { Status } from '../types/db'
import { User } from '../types/auth'
import Nav from '../components/nav'

const Home: NextPage = () => {
  const [auth, signOut] = useAuth()

  const data: User = {
    id: auth.uid,
    email: auth.email,
    name: auth.displayName,
    image: auth.photoURL,
    signOut,
  }

  const handleAdd = () => {
    api.add(auth.uid, {
      name: 'sarasa',
      status: Status.IN_EVALUATION,
      createdAt: Timestamp.now().toDate(),
    })
  }

  return (
    <div className={styles.container}>
      <Head>
        <title>Create Next App</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>

      <Nav data={data} />
      <main className={styles.main}>
        Bievenido {auth.displayName}
        <button onClick={signOut}>logout</button>
        <button onClick={handleAdd}>add</button>
      </main>

      <footer className={styles.footer}>FOOTER</footer>
    </div>
  )
}

export default Home
